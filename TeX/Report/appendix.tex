\clearpage
\appendix

\section{Basics in Convex Analysis}
\label{Sec:Ann:ConvexAnalysis}
\begin{eqnarray}
y = P_K(x) & \Longleftrightarrow &
\begin{array}{ll}
  \min &\frac 1 2 (y-x)^\top (y-x ) \\
  \text {s.t. } & y \in K
\end{array}
\\
& \Longleftrightarrow & - (y-x) \in N_K(y) \\
& \Longleftrightarrow & (x-y)^\top(y-z) \geq 0, \forall z \in K 
\label{eq:tutu}
\end{eqnarray}

\begin{eqnarray}
-F(x) \in N_K(x) & \Longleftrightarrow & -\rho F(x)^\top(y-x) \geq 0, \forall y \in K\\
& \Longleftrightarrow &  (x-(x - \rho F(x))^\top(y-x) \geq 0, \forall y \in K \\
& \Longleftrightarrow &  x = P_K(x- \rho F(x)) \text{ thanks to (\ref{eq:tutu})} 
\end{eqnarray}

\begin{equation}
  \label{eq:sub-norm}
  \partial \|z\|_2 =
  \begin{cases}
      \Frac z {\|z\|}\\
      \{x, \|x\|=1 \}
    \end{cases}
\end{equation}
\subsection{Euclidean projection on the disk  in $\RR^2$.}
Let $D=\{x \in \RR^3, \|x\| \leq 1\}$. We have 
\begin{equation}
  \label{eq:projD}
  P_{D}(z) =\left\{
  \begin{array}{lcl}
    z &\text{if}& z \in D \\
    \Frac {z} {\|z\|}& \text{if}&z \notin D
    \end{array}\right. 
  \end{equation}
 and
\begin{equation}
  \label{eq:sub-projD}
  \partial P_{D}(z) =\left\{
  \begin{array}{lcl}
   I &\text{if }& z \in D \setminus \partial D \\
   I + (s-1)z z^\top , s\in [0,1]   &\text{if }& z \in  \partial D \\
   \Frac I {\|z\|} - \Frac{z z^\top}{\|z\|^3} &\text{if }& z \notin D  
   \end{array}\right. 
\end{equation}


\subsection{Euclidean projection on the second order cone of $\RR^3$.}
Let $K=\{x = [x_\n x_\t]^T \in \RR^3, x_\n \in \RR, \|x_{\t}\| \leq \mu x_{\n}\}$. We have 
\begin{equation}
  \label{eq:proj}
  P_{K}(z) =\left\{
  \begin{array}{lcl}
    z &\text{if}& z \in K \\
    0 &\text{if}& -z \in K^* \\
    \Frac 1 {1+\mu^2}(z_\n + \mu \|z_\t\| )
    \left[\begin{array}{c}
      1 \\
      \mu \Frac {z_\t} {\|z_\t\|}
      \end{array}\right]&\text{if}& z \notin K \text{ and } -z \notin K^*
    \end{array}\right. 
  \end{equation}

\paragraph{Direct computation of an element of the subdifferential}

The computation of the subdifferential are given as follows
\begin{itemize}
\item if $z\in K\setminus \partial K$, $\partial_z P_K(z) =I$,
\item if $-z \in K^*\setminus \partial K^*$, $\partial_z P_K(z) =0$,
\item if $z \notin K$ and $-z \notin K^*$ and, $\partial_z P_K(z) =0$, we get
\begin{equation}
  \label{eq:sub-proj_n}
  \partial_{z_\n} P_{K}(z) =
  % \left\{\begin{array}{lcl}
  \Frac 1 {1+\mu^2}
  \left[
    \begin{array}{c}
      1 \\
      \mu z_\t
    \end{array}\right] 
  % \end{array}\right. 
\end{equation}
and
\begin{equation}
  \label{eq:sub-proj_t1}
  \partial_{z_\t} [P_{K}(z)]_\n =
  % \left\{\begin{array}{lcl}
  \Frac \mu {1+\mu^2} \Frac {z_\t} {\|z_\t\|}
  % \end{array}\right. 
\end{equation}
\begin{equation}
  \label{eq:sub-proj_2}
  \partial_{z_\t} [P_{K}(z)]_\t =
  % \left\{\begin{array}{lcl}
  \Frac {\mu} {(1+\mu^2)} \left[\mu \Frac {z_\t} {\|z_\t\|} \Frac {z^\top_\t} {\|z_\t\|}+ (z_\n + \mu \|z_\t\|) (\Frac{I_2}{\|z_\t\|} - \Frac{z_\t z_\t^\top}{\|z_\t\|^3} )\right]
  % \end{array}\right. 
\end{equation}
that is
\begin{equation}
  \label{eq:sub-proj_2}
  \partial_{z_\t} [P_{K}(z)]_\t =
  % \left\{\begin{array}{lcl}
  \Frac {\mu} {(1+\mu^2)\|z_\t\|} \left[ (z_\n + \mu \|z_\t\|) \,I_2   +  z_\n  \Frac{z_\t z_\t^\top}{\|z_\t\|^2} )\right]
  % \end{array}\right. 
\end{equation}
\begin{ndrva}
  to be checked carefully
\end{ndrva}

\end{itemize}


\paragraph{Computation of the subdifferential using the spectral decomposition}


In~\cite{Hayashi.ea_SIOPT2005}, the computation of the Clarke subdifferential of the projection operator is also done by inspecting the different cases using the spectral decomposition
\begin{equation}
  \label{eq:Jordan-projection-Jacobian}
  \partial P_K(x) =
  \left\{
    \begin{array}{ll}
      I & \quad (\lambda_1>0, \lambda_2 >0 ) \\
      \Frac{\lambda_2}{\lambda_1+\lambda_2} I +Z & \quad (\lambda_1< 0, \lambda_2 >0 ) \\
      0 & \quad (\lambda_1< 0, \lambda_2 <0 ) \\
      \co\{I, I+Z\} & \quad (\lambda_1=0, \lambda_2 >0 ) \\
      \co\{0, Z\} & \quad (\lambda_1<0, \lambda_2 =0 ) \\
      \co\{0 \cup  I \cup S\}  & \quad (\lambda_1=0, \lambda_2 =0 )
    \end{array}
  \right.
\end{equation}
where
\begin{equation}
  \label{eq:Jordan-projection-Jacobian2}
  \begin{array}{l}
  Z  = \frac 1 2
  \begin{bmatrix}
    - y_\n & y_\t^\top\\
    y_\t & - y_\n y_\t y_\t^\top
  \end{bmatrix},\\
  S = \left\{\frac 1 2 (1+\beta) I + \frac 1 2
    \begin{bmatrix}
      -\beta & w^\top \\
      w & -\beta w w^\top
    \end{bmatrix}\mid -1 \leq \beta \leq 1, \|w\|=1\right\}
\end{array}
\end{equation}
with $y = x / \|x_\t\|$. A simple verification shows that the previous computation is an element of the subdifferential.



\begin{ndrva}
  to be checked carefully
\end{ndrva}





\section{Computation of Generalized Jacobians for Nonsmooth Newton methods}
\subsection{Computation of components of subgradient of $F_{\vitwo}^\nat$}



 Let us introduce the following notation for an element of the sub--differential
\begin{equation}
  \label{eq:Phi-natural-typeII}
  \Phi(u, r)  = \left[
  \begin{array}{cc}
    \rho  I  &   - \rho W \\
     \Phi_{r u}(u,r) &   \Phi_{r r}(u,r)
  \end{array}\right] \in \partial F_{\vitwo}^\nat(u,r)
\end{equation}
where $ \Phi_{x y}(u,r) \in \partial_{x}[F_{\vitwo}^\nat]_{y}(u,r)$. Since $\Phi_{u u}(u,r) = I $, a reduction of the system is performed in practise and Algorithm~\ref{Algo:NSN} is applied or $z =r$ with
\begin{equation}
  \label{eq:phiphi}
  \begin{cases}
    G(z) = [F_{\vitwo}^\nat]_{r}(Wr+q,r) \\
    \Phi(z) = \Phi_{rr}(r,Wr+q) + \Phi_{ru}(r,Wr+q) W
  \end{cases}
\end{equation}
\begin{ndrva}
  to be checked carefully. compare with \cite{Hayashi.ea_SIOPT2005}
\end{ndrva}

 Let us introduce the following notation for an element of the sub--differential with a obvious simplification
\begin{equation}
  \label{eq:Phi-natural-typeI}
  \Phi(v,  r)  = \left[
  \begin{array}{ccc}
   \rho M &  - \rho H  \\
   -\rho H^\top &  \rho I &   0  \\
   0  &   \Phi_{r u}(v,u,r) &   \Phi_{r r}(v,u,r)
 \end{array}\right] \in \partial F_{\vitwo}^\nat(u,r)
\end{equation}
where $ \Phi_{x y}(v,u,r) \in \partial_{x}[F_{\vione}^\nat]_{y}(v,u,r)$. A possible computation of  $\Phi_{r u}(v,u,r)$ and $\Phi_{r r}(v,u,r) $ is directly given by~(\ref{eq:Phi-natural-typeII-ru}) and (\ref{eq:Phi-natural-typeII-rr}). In this case, the variable $u$ can be also substituted.







\label{Sec:Phi-natural-typeII}
 For one contact, a possible computation of the remaining parts in $\Phi(u, r)$  is given by
\begin{equation}
  \label{eq:Phi-natural-typeII-rr}
   \Phi_{r u}(u,r)  = 
  \left\{
    \begin{array}{lcl}
      0  & \text { if } & r- \rho(u+g(u)) \in K    \\ \\
      I - \partial_{r}[P_K(r-\rho(u+g(u)))]  & \text { if } &r- \rho(u+g(u))   \notin K
    \end{array}\right.
\end{equation}

\begin{equation}
  \label{eq:Phi-natural-typeII-ru}
  \Phi_{r u}(u,r) = 
  \left\{
    \begin{array}{lcl}
      \rho \left(I +
      \left[\begin{array}{ccc}
          0 & 0 & 0 \\
          \Frac{u_\t}{\|u_\t\|} & 0 & 0 \\
        \end{array}\right]
      \right)  & \text { if } &
      \begin{cases}
        r- \rho(u+g(u)) \in K \\ u_\t \neq 0
      \end{cases}
      \\ \\
      \rho\left(I +  \left[\begin{array}{ccc}
          0 & 0 & 0 \\
          s & 0 & 0 \\
        \end{array}\right]\right), s \in \RR^2 , \|s\|=1  & \text { if } &
    \begin{cases}
      r- \rho(u+g(u)) \in K \\ u_\t = 0
    \end{cases}
    \\ \\
      I        +\rho \left(I +  \left[\begin{array}{ccc}
          0 & 0 & 0 \\
          \Frac{u_\t}{\|u_\t\|} & 0 & 0 \\
        \end{array}\right]\right)    \partial_{u}[P_K(r-\rho(u+g(u)))] & \text { if } &r- \rho(u+g(u))   \notin K
    \end{array}\right.
\end{equation}
The computation of an element of $\partial P_K$ is given in Appendix~\ref{Sec:Ann:ConvexAnalysis}.


\subsection{Alart--Curnier function and its variants}
\label{Sec:Phi-AC-II}

For one contact, a possible computation of the remaining parts in $\Phi(u, r)$  is given by

\begin{equation}
  \label{eq:Phi-AC-II-rnun}
   \Phi_{r_\n u_\n}(u,r) =  \left\{
   \begin{array}{ll}
     \rho_{\n} & \text{ if }  r_{\n} - \rho_{\n} u_{\n} > 0 \\
     0  & \text{ otherwise }
    \end{array}\right.
\end{equation}
\begin{equation}
  \label{eq:Phi-AC-II-rnrn}
  \Phi_{r_\n r_\n}(u,r) =
  \left\{
    \begin{array}{ll}
      0 & \text{ if }  r_{\n} - \rho_{\n} u_{\n} > 0 \\
      1  & \text{ otherwise }
    \end{array}\right.
\end{equation}

\begin{equation}
  \label{eq:Phi-AC-II-rtun}
  \Phi_{r_\t u_\n}(u,r) =
  \left\{
    \begin{array}{ll}
      0 & \text{ if }  \|r_{\t}  - \rho_{\t} u_{\t}\| \leq  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
      0 & \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
        r_{\n} - \rho_{\n} u_n\leq 0
      \end{cases} \\
     \mu \rho_{\n}  \Frac{r_{\t} - \rho_{\t} u_{\t} }{ \| r_{\t} - \rho_{\t} u_{\t}\| }   &  \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
        r_{\n} - \rho_{\n} u_n > 0
      \end{cases} \\
    \end{array}\right.
\end{equation}
\begin{equation}
  \label{eq:Phi-AC-II-rtut}
  \Phi_{r_\t u_\t}(u,r) =
  \left\{
    \begin{array}{ll}
      \rho_{\t} & \text{ if }  \|r_{\t}  - \rho_{\t} u_{\t}\| \leq  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
     \mu\rho_{\t}(r_{\n} - \rho_{\n} u_\n )_+ \Gamma(r_{\t} - \rho_{\t} u_{\t})
      &  \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
        r_{\n} - \rho_{\n} u_n > 0
      \end{cases} \\
    \end{array}\right.
\end{equation}
\begin{equation}
  \label{eq:Phi-AC-II-rtrn}
  \Phi_{r_\t r_\n}(u,r) =
  \left\{
    \begin{array}{ll}
      0 & \text{ if }  \|r_{\t}  - \rho_{\t} u_{\t}\| \leq  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
      0 & \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
        r_{\n} - \rho_{\n} u_n\leq 0
      \end{cases} \\
       -\mu  \Frac{r_{\t} - \rho_{\t} u_{\t} }{ \| r_{\t} - \rho_{\t} u_{\t}\| }  &  \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
         r_{\n} - \rho_{\n} u_n > 0
      \end{cases} \\
    \end{array}\right.
\end{equation}
\begin{equation}
  \label{eq:Phi-AC-II-rtrt}
  \Phi_{r_\t r_\t}(u,r) =
  \left\{
    \begin{array}{ll}
      0 & \text{ if }  \|r_{\t}  - \rho_{\t} u_{\t}\| \leq  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
      I_2-\mu(r_{\n} - \rho_{\n}u_\n )_+ \Gamma(r_{\t} - \rho_{\t} u_{\t})    &  \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu \max (0 ,r_{\n} - \rho_{\n} u_\n )  \\
        r_{\n} - \rho_{\n} u_n > 0
      \end{cases} \\
    \end{array}\right.
\end{equation}
with
 the function $\Gamma(\cdot)$  defined by
\begin{equation}
  \label{eq:AC-L12}
  \Gamma(x) = \Frac{I_{2\times 2}}{\|x\|} - \Frac{x\,x^\top}{\|x\|^3}
\end{equation}

If the variant~(\ref{eq:Moreau--Jean-1}) is chosen, the computation of $\Phi_{r_\t \bullet}$  simplify in
\begin{equation}
  \label{eq:Phi-CKPS-II-rtun}
  \Phi_{r_\t u_\n}(u,r) =   0
\end{equation}
\begin{equation}
  \label{eq:Phi-CKPS-II-rtut}
  \Phi_{r_\t u_\t}(u,r) =
  \left\{
    \begin{array}{ll}
      \rho_{\t} & \text{ if }  \|r_{\t}  - \rho_{\t} u_{\t}\| \leq  \mu r_\n  \\
      -\mu\rho_\t r_{n,+} \Gamma(r_\t-\rho_\t u_\t) & \text{ if }
      \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu r_\n  \\
    \end{array}\right.
\end{equation}
\begin{equation}
  \label{eq:Phi-CKPS-II-rtrn}
  \Phi_{r_\t r_\n}(u,r) =
  \left\{
    \begin{array}{ll}
      0 & \text{ if }  \|r_{\t}  - \rho_{\t} u_{\t}\| \leq  \mu r_{\n}  \\
      0 & \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu r_n  \\
        r_{\n} \leq 0
      \end{cases} \\
       -\mu  \Frac{r_{\t} - \rho_{\t} u_{\t} }{ \| r_{\t} - \rho_{\t} u_{\t}\| }  &  \text{ if }
      \begin{cases}
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu r_n  \\
        r_{\n}  > 0
      \end{cases} \\
    \end{array}\right.
\end{equation}

\begin{equation}
  \label{eq:Phi-CKPS-II-rtrt}
  \Phi_{r_\t r_\t}(u,r) =
  \left\{
    \begin{array}{ll}
      0 & \text{ if }  \|r_{\t}  - \rho_{\t} u_{\t}\| \leq  \mu r_{\n}\\
      I_2-\mu (r_{\n})_+ \Gamma(r_{\t} - \rho_{\t} u_{\t})    &  \text{ if }
        \|r_{\t}  - \rho_{\t} u_{\t}\| >  \mu r_{\n}  \\
    \end{array}\right.
\end{equation}

\begin{ndrva}
  \begin{list}{*}{}
  \item     Is    there    a    difference    with    the    computation    of    Florent    in    his    thesis?
  \item
  \end{list}
\end{ndrva}


\subsection{Fischer-Burmeister function}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "paper"
%%% End: 
